swagger: '2.0'
info:
  description: "API for RxPData functional module for dispense record on [RxPData API Definition](https://oneit.wba.com/confluence/x/akEVAw)."
  version: 3.4.0
  title: RxPData API
basePath: /v1
schemes:
- http
produces:
- application/json
paths:
  /prescriptions/search:
    post:
      tags:
      - Prescription
      summary: Get the List of dispenses by Location Number, Location Type and Rx Number or by Patient code and status
      description: Get the list of dispenses by Location Number, Location Type and Rx Number or by Patient code and status
      operationId: "searchPrescriptionList"
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - in: body
        name: PrescriptionDispenseFilter
        description: search the dispenses or prescription
        required: true
        schema:
          $ref: '#/definitions/PrescriptionDispenseFilter'
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/PrescriptionList'
        '400':
          description: Business Exception
          schema:
            $ref: '#/definitions/ExecuteException'
        '500':
          description: Server Error
          schema:
            $ref: '#/definitions/ExecuteException'
      security:
      - basicAuth: []
  /prescriptions/{prescriptionCode}/dispenses/{dispenseCode}:
    get:
      tags:
      - Prescription
      summary: Get the Dispense record by dispense code
      description: Get the Dispense record by dispense code
      operationId: "readDispense"
      produces:
      - application/json
      parameters:
      - in: path
        name: prescriptionCode
        type: string
        required: true
        description: Prescription code
      - in: path
        name: dispenseCode
        type: string
        required: true
        description: Dispense code
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/Dispense'
        '400':
          description: Business Exception
          schema:
            $ref: '#/definitions/ExecuteException'
        '500':
          description: Server Error
          schema:
            $ref: '#/definitions/ExecuteException'
      security:
      - basicAuth: []
  /prescriptions/{prescriptionCode}:
    get:
      tags:
      - Prescription
      summary: Get the Prescription record by prescription code
      description: Get the Prescription record by prescription code
      operationId: readPrescription
      produces:
      - application/json
      parameters:
      - in: path
        name: prescriptionCode
        type: string
        required: true
        description: Prescription code
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/Prescription'
        '400':
          description: Business Exception
          schema:
            $ref: '#/definitions/ExecuteException'
        '500':
          description: Server Error
          schema:
            $ref: '#/definitions/ExecuteException'
      security:
      - basicAuth: []
  /prescriptions/{prescriptionCode}/dispenses:
    get:
      tags:
      - Prescription
      summary: Get the list of dispenses record by prescription code
      description: Get the list of dispenses record by prescription code
      operationId: readDispensesByPrescriptionCode
      produces:
      - application/json
      parameters:
      - in: path
        name: prescriptionCode
        type: string
        required: true
        description: Prescription code
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/DispenseList'
        '400':
          description: Business Exception
          schema:
            $ref: '#/definitions/ExecuteException'
        '500':
          description: Server Error
          schema:
            $ref: '#/definitions/ExecuteException'
      security:
      - basicAuth: []
  /prescriptions/internal-rx-refillability-validation:
    post:
      tags:
      - Refillability-Validation
      summary: Validate if an internal prescription is refillable
      description: Validate if an internal prescription is refillable and set default qty and days supply
      operationId: "validateInternalRxRefillability"
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - in: body
        name: validateInternalRxRefillabilityRequest
        description: interal prescription data
        required: true
        schema:
          $ref: '#/definitions/ValidateInternalRxRefillabilityRequest'
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/ValidateInternalRxRefillabilityResponse'
        '400':
          description: Business Exception
          schema:
            $ref: '#/definitions/ExecuteException'
        '500':
          description: Server Error
          schema:
            $ref: '#/definitions/ExecuteException'
      security:
      - basicAuth: []
  /prescriptions/external-rx-refillability-validation:
    post:
      tags:
      - Refillability-Validation
      summary: Validate if an external prescription is refillable
      description: Validate if an external prescription is refillable and set default qty and days supply
      operationId: "validateExternalRxRefillability"
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - in: body
        name: validateExternalRxRefillabilityRequest
        description: external prescription data
        required: true
        schema:
          $ref: '#/definitions/ValidateExternalRxRefillabilityRequest'
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/ValidateExternalRxRefillabilityResponse'
        '400':
          description: Business Exception
          schema:
            $ref: '#/definitions/ExecuteException'
        '500':
          description: Server Error
          schema:
            $ref: '#/definitions/ExecuteException'
      security:
      - basicAuth: []
  /prescriptions/dayssupply-calculation:
    post:
      tags:
      - Dayssupply-Calculation
      summary: Calculate days supply
      description: Calculate days supply based on the input
      operationId: "calculateDaysSupply"
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - in: body
        name: calculateDaysSupplyRequest
        description: input data used for days supply calculation
        required: true
        schema:
          $ref: '#/definitions/CalculateDaysSupplyRequest'
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/CalculateDaysSupplyResponse'
        '400':
          description: Business Exception
          schema:
            $ref: '#/definitions/ExecuteException'
        '500':
          description: Server Error
          schema:
            $ref: '#/definitions/ExecuteException'
      security:
      - basicAuth: []
securityDefinitions:
  basicAuth:
    description: HTTP Basic Authentication
    type: basic
definitions:
  CalculateDaysSupplyRequest:
    type: object
    required:
    - dispensingQuantity
    properties:
      dispensingQuantity:
        type: number
        format: double
        description:  current quantity to be dispensed
      lastDispensedQuantity:
        type: number
        format: double
        description: dispensed quantity from the last dispense
      lastDaysSupply:
        type: integer
        format: int32
        description: days supply from the last dispense
  CalculateDaysSupplyResponse:
    type: object
    properties:
      calculatedDaysSupply:
        type: number
        format: double
        description:  calculated days supply for the current quantity
  Name:
    type: object
    required:
    - firstName
    - lastName
    properties:
      firstName:
        type: string
      lastName:
        type: string
      middleNameInitial:
        type: string
      initials:
        type: string
  ExternalIdentifier:
    type: object
    required:
    - name
    - value
    properties:
      name:
        type: string
      value:
        type: string
  DispenseList:
    type: object
    properties:
      dispenses:
        type: array
        items:
          $ref: '#/definitions/Dispense'
  PrescriptionList:
    type: object
    properties:
      prescriptions:
        type: array
        items:
          $ref: '#/definitions/Prescription'
  RxNumberFilter:
    type: object
    required:
    - location
    - rxNumber
    properties:
      location:
        description: location and External Rx Number are composite key
        $ref: '#/definitions/LocationIdentifier'
      rxNumber:
        description: External Rx Number
        type: string
  PatientDispenseFilter:
    type: object
    required:
    - patientCode
    properties:
      patientCode:
        description: Patient code
        type: string
      dispenseStatus:
        description: Status of the dispense
        type: string
        enum:
        - ENTERED
        - REVIEWED
        - PRINTED
        - FILLED
        - READY
        - DELIVERED
        - DELETED
  PrescriptionDispenseFilter:
    type: object
    properties:
      rxNumberFilter:
        description: location and External Rx Number are composite key
        $ref: '#/definitions/RxNumberFilter'
      patientDispenseFilter:
        description: PatientCode and status are composite key
        $ref: '#/definitions/PatientDispenseFilter'
      dispenseCode:
        description: Dispense Code
        type: string
  Dispense:
    type: object
    required:
    - code
    - daysSupply
    - dispenseNumber
    - location
    - prescriptionCode
    - quantityDispensed
    - rxNumber
    - status
    - prescriber
    properties:
      actualProductPackCode:
        type: string
        description: The actual product pack code dispensed
      authorizer:
        type: string
        description: Authorizer
      code:
        type: string
        description: The dispense code of the prescription
      coupon:
        type: boolean
        description: Coupon indicator
      couponActualProductPackCode:
        type: string
        description: Coupon actual product pack code
      createdDateTime:
        type: string
        format: date-time
        description: dispense created Date Time
      dataEnteredBy:
        description: data entered by
        $ref: "#/definitions/EmployeeIdentifier"
      daysSupply:
        type: integer
        format: int32
        description: Days supply of the dispense
      dispenseNumber:
        type: integer
        format: int32
      deletedBy:
        $ref: "#/definitions/EmployeeIdentifier"
        description: deleted entered by
      deletedDateTime:
        type: string
        format: date-time
      deletedReason:
        type: string
        enum:
        - NOT_AVAILABLE
        - BILLING_EXCEPTION
        - CLIENICAL_EXCEPTION
        - WRONG_DRUG
        - WRONG_DIRECTIONS
        - WRONG_QUANTITY
        - WRONG_STRENGTH
        - WRONG_PATIENT
        - WRONG_PRESCRIBER
      generalRecipientNumber:
        type: string
        description: General receipient number
      location:
        $ref: "#/definitions/LocationIdentifier"
        description: Location number
      originCode:
        type: string
        description: Dispensing Origin Code
        enum:
        - ERX
        - FAX
        - IVR
        - MAIL
        - PHARMACY
        - PHONE
        - WALKIN
      patientResponsibility:
        description: Patient payment amount
        $ref: "#/definitions/Currency"
      patPbrDataReviewedBy:
        description: Patient and Prescriber information Reviewed by
        $ref: "#/definitions/EmployeeIdentifier"
      payCode:
        type: string
        description: Pay code
      paymentMethod:
        type: string
        description: Payment Method
        enum:
        - CASH
        - COUPON
        - STANDARD_PLAN
        - WORKERS_COMP
      pharmacistOfRecord:
        description: pharmacist Of Record
        $ref: "#/definitions/EmployeeIdentifier"
      planCode:
        type: string
        description: Plan code
      prescriber:
        $ref: "#/definitions/DispensePrescriber"
        description: Dispense Prescriber attributes
      prescriptionCode:
        type: string
        description: Prescription code of the dispense
      priceOverrideAmount:
        description: Price override amount
        $ref: "#/definitions/Currency"
      priorAuthorizationCode:
        type: string
        description: Prior authorization code
      priorAuthorizationNumber:
        type: string
        description: Prior authorization number
      productDataReviewedBy:
        description: Product information Reviewed by
        $ref: "#/definitions/EmployeeIdentifier"
      quantityDispensed:
        type: number
        format: double
        description: Quantity dispensed
      rxNumber:
        type: string
        description: External rx number
      servicePlace:
        type: string
        description: Place of service
        enum:
        - HEALTHCARE_CLINIC
        - NURSING_HOME
        - PHARMACY
        - SCHOOL
      soldAmount:
        description: Sold amount of the dispense
        $ref: "#/definitions/Currency"
      soldBy:
        description: dispese sold by
        $ref: "#/definitions/EmployeeIdentifier"
      soldDateTime:
        type: string
        format: date-time
        description: Sold date time of the dispense
      status:
        type: string
        description: Status of the dispense
        enum:
        - ENTERED
        - REVIEWED
        - PRINTED
        - FILLED
        - READY
        - DELIVERED
        - DELETED
  Prescription:
    type: object
    required:
    - code
    - printGenericProductName
    - rxStatus
    - specDirection
    - specDispenseAsWritten
    - specImmutable
    - specLocation
    - specNumberRefill
    - specOriginalQuantityPrescribed
    - specPatientCode
    - specPrescriberCode
    - specPrescriberLocationCode
    - specUnlimitedFill
    - specWrittenDate
    properties:
      code:
        type: string
        description: Code of the prescription
      externalIdentifiers:
        type: array
        items:
          $ref: '#/definitions/ExternalIdentifier'
      externalSource:
        type: string
        enum:
        - ICPLUS
      externalQuantityRemaining:
        type: number
        format: double
        description: remaining quantity from external system at the time of the import
      externalDataEnteredBy:
        $ref: '#/definitions/Name'
      externalDataEnteredDatetime:
        type: string
        format: date-time
        description: entered date time
      externalLastDispenseEnteredDateTime:
        type: string
        format: date-time
      externalLastPatientPrescriberDataReviewedBy:
        $ref: '#/definitions/Name'
      externalLastPatientPrescriberDataReviewedDateTime:
        type: string
        format: date-time
      externalLastProductDataReviewedBy:
        $ref: '#/definitions/Name'
      externalLastProductDataReviewedDateTime:
        type: string
        format: date-time
      externalRxScannedBy:
        $ref: '#/definitions/Name'
      rxAuthorizer:
        type: string
        description: Authorizer of the prescription
      autoRefill:
        type: boolean
        description: Auto refill indicator
      rxComments:
        type: string
        description: Comments of the prescription
      genericSubstitutePreference:
        type: boolean
        description: Generic substitute preference indicator
      intermediaryAuthorizationId:
        type: string
        description: Intermediary authorization id
      printGenericProductName:
        type: boolean
        description: Print Generic Product Name indicator
      printSavings:
        type: boolean
        description: Print savings indicator
      publicSafetyDepartmentNumber:
        type: string
        description: Public safety department number
      quantityRemaining:
        type: number
        format: double
        description: Quantity remaining
      refillsRemaining:
        type: number
        format: double
        description: Refills remaining
      rxStatus:
        type: string
        description: status of the prescription
        enum:
        - ACTIVE
        - CLOSED
        - DELETED
      rxClosedReason:
        type: string
        description: closed reason of the prescription
        enum:
        - CANCELED_BY_PRESCRIBER
        - TRANSFER_TO_COMPETITOR
        - TRANSFER_TO_WAG_STORE
        - OTHER
      rxClosedBy:
        description: prescription closed by
        $ref: "#/definitions/EmployeeIdentifier"
      rxClosedDateTime:
        type: string
        format: date-time
        description: prescription closed Date Time
      rxClosedComment:
        type: string
        description: prescription closed comment
      substituteType:
        type: string
        description: Substitute Type
        enum:
        - GENERIC
        - NONE
        - THERAPEUTIC
      specDirection:
        type: string
        description: Direction of the specification
      specExpandedDirection:
        type: string
        description: Decoded values of the SpecDirection of the specification
      specDispenseAsWritten:
        type: boolean
        description: Dispense as written indicator
      specImageId:
        type: string
        description: Reference code to identify the prescription Image
      specImmutable:
        type: boolean
        description: Immutable indicator
      specLocation:
        $ref: '#/definitions/LocationIdentifier'
      specNumberRefill:
        type: integer
        format: int32
        description: Number of refills prescribed
      specOriginalQuantityDispensed:
        type: number
        format: double
        description: Original quantity dispensed
      specOriginalQuantityPrescribed:
        type: number
        format: double
        description: Original quantity prescribed
      specOriginalScannedDateTime:
        type: string
        format: date-time
      specOriginCode:
        type: string
        description: Origin of the prescription
        enum:
        - ERX
        - FAX
        - IVR
        - MAIL
        - PHARMACY
        - PHONE
        - WALKIN
      specPatientCode:
        type: string
        description: Patient code for the specification
      specPrescribedActualProductPackCode:
        type: string
        description: Prescribed actual product pack code for the specification
      specPrescriberCode:
        type: string
        description: Prescriber code for the specification
      specPrescriberDeaNumber:
        type: string
        description: Prescriber dea number for the specification
      specPrescriberDeaSuffix:
        type: string
        description: Prescriber dea suffix for the specification
      specPrescriberLocationCode:
        type: string
        description: Prescriber location code for the specification
      specPrescriberSupervisorFirstName:
        type: string
        description: Prescriber supervisor first name for the specification
      specPrescriberSupervisorLastName:
        type: string
        description: Prescriber supervisor last name for the specification
      specFillExpirationDate:
        type: string
        format: date
        description: The refill expiration date
      specTotalQuantityPrescribed:
        type: number
        format: double
        description: Total quantity prescribed
      specUnlimitedFill:
        type: boolean
        description: Unlimited fill indicator
      specWrittenDate:
        type: string
        format: date
        description: Written date of the specification
      dispenses:
        type: array
        items:
          $ref: '#/definitions/Dispense'
      transferToPharmacyName:
        type: string
        description: Pharmacy name to which prescription to be transferred
      transferToPharmacyPharmacistName:
        type: string
        description: Pharmacist Name of the pharmacy to which prescription to be transferred
      transferToPharmacyPhoneNumber:
        type: string
        description: Pharmacy store phone number to which prescription to be transferred
      transferToPharmacyStoreNumber:
        type: string
        description: Pharmacy store number to which prescription to be transferred
  EmployeeIdentifier:
    type: object
    required:
    - employeeNumber
    - employeeType
    properties:
      employeeNumber:
        type: string
        description: employee number
      employeeType:
        type: string
        description: employee type
        enum:
        - CONSULTANT
        - CSR
        - EMPLOYEE
        - WAGBPO
        - WHSCSR
  DispensePrescriber:
    type: object
    required:
    - prescriberFirstName
    - prescriberLastName
    properties:
      prescriberAddressLine1:
        type: string
        description: prescriber AddressLine1
      prescriberAddressLine2:
        type: string
        description: prescriber AddressLine2
      prescriberCity:
        type: string
        description: prescriber City
      prescriberFirstName:
        type: string
        description: prescriber FirstName
      prescriberLastName:
        type: string
        description: prescriber LastName
      prescriberNpi:
        type: string
        description: prescriber NPI
      prescriberPhoneNumber:
        type: string
        description: prescriber PhoneNumber
      prescriberSuffix:
        type: string
        description: prescriber suffix
      prescriberState:
        type: string
        description: prescriber state
      prescriberType:
        type: string
        description: prescriber Type
      prescriberZipCode:
        type: string
        description: prescriber ZipCode
  Currency:
    type: object
    required:
    - isoCode
    - decimalValue
    properties:
      amount:
        type: string
        description: Amount of the value
      isoCode:
        type: string
        description: ISO code (USD)
      symbol:
        type: string
        description: Symbol of the iso code ($)
      decimalValue:
        type: number
        description: Decimal Value
      formattedAmount:
        type: string
        description: Decimal Value
  LocationIdentifier:
    type: object
    required:
    - locationNumber
    - locationType
    properties:
      locationNumber:
        type: string
        description: Location number
      locationType:
        type: string
        description: Location type
        enum:
        - Pharmacy
        - Store
        - HealthcareClinic
  LastExternalDispense:
    type: object
    properties:
      actualProductPackCode:
        type: string
      daysSupply:
        type: integer
        format: int32
      inProcess:
        type: boolean
      location:
        $ref: "#/definitions/LocationIdentifier"
        description: Location number
      paymentMethod:
        type: string
        description: Payment Method
        enum:
        - CASH
        - COUPON
        - STANDARD_PLAN
        - WORKERS_COMP
      planCode:
        type: string
        description: Plan code
      quantityDispensed:
        type: number
        format: double
        description: Quantity dispensed
  ExternalPrescription:
    type: object
    properties:
      direction:
        type: string
        description: Direction of the prescription
      fillExpirationDate:
        type: string
        format: date
        description: The prescription expiration date
      lastDispense:
        $ref: '#/definitions/LastExternalDispense'
      originalQuantityPrescribed:
        type: number
        format: double
        description: Original quantity prescribed
      numberRefill:
        type: integer
        format: int32
        description: Number of refills prescribed
      prescriberCode:
        type: string
        description: Prescriber code for the specification
      prescriberLocationCode:
        type: string
        description: Prescriber location code for the specification
      quantityRemaining:
        type: number
        format: double
        description: Quantity remaining
      rxStatus:
        type: string
        description: status of the prescription
        enum:
        - ACTIVE
        - CLOSED
        - NOT_PROCESSABLE
      unlimitedFill:
        type: boolean
        description: Unlimited fill indicator
      validPrescriberIndicator:
        type: boolean
        description: indicate if the prescriber is valid or not based on IC+ pbr status
  ValidateExternalRxRefillabilityRequest:
    type: object
    required:
    - dispensingLocation
    - externalPrescription
    properties:
      dispensingLocation:
        description: the current dispensing location
        $ref: '#/definitions/LocationIdentifier'
      patientCode:
        type: string
      externalPrescription:
        description: external prescription data
        $ref: '#/definitions/ExternalPrescription'
  ValidateExternalRxRefillabilityResponse:
    type: object
    properties:
      defaultDaysSupply:
        type: number
        format: double
        description: Calculated Days supply based on the default dispensing quantity
      defaultDispensingQuantity:
        type: number
        format: double
        description: Default quantity to be dispensed
      expandedDirection:
        type: string
        description: Decoded values of the direction of the prescription
      nonRefillableReason:
        type: string
        description: Reason why the precription cannot be refilled
        enum:
        - COMPOUND_NONSYSTEM_PRODUCT
        - CONTROLLED_PRODUCT
        - COUPON_PLAN_USED
        - EXCEED_MAX_REFILLS_ALLOWED
        - EXTERNAL_DISPENSE_IN_PROGRESS
        - GOVERNMENT_PLAN_USED
        - INFRASTRUCTURE_ISSUE
        - INVALID_PRESCRIBER
        - NO_QUANTITY_REMAINING
        - OUT_OF_STATE_REFILL
        - PLAN_REQUIRES_CERTIFICATION
        - PRESCRIPTION_CLOSED
        - PRESCRIPTION_DELETED
        - PRESCRIPTION_EXPIRED
        - PRESCRIPTION_STORED
        - PRODUCT_DISCONTINUED
        - PRODUCT_EXCLUDED
        - WORKERS_COMP_USED
      refillable:
        type: boolean
        description: Flag to indicate if the prescription is eligible for refill or not
  ValidateInternalRxRefillabilityRequest:
    type: object
    required:
    - dispensingLocation
    - internalRxRefillabilityRequestList
    properties:
      dispensingLocation:
        description: the current dispensing location
        $ref: '#/definitions/LocationIdentifier'
      internalRxRefillabilityRequestList:
        type: array
        items:
          $ref: '#/definitions/InternalRxRefillabilityRequest'
  InternalRxRefillabilityRequest:
    type: object
    required:
    - lastDispenseCode
    properties:
      lastDispenseCode:
        description: dispense code from the last dispense
        type: string
      prescriptionCode:
        description: prescription code
        type: string
      rxStatus:
        description: prescription status
        type: string
        enum:
        - ACTIVE
        - CLOSED
        - DELETED
  ValidateInternalRxRefillabilityResponse:
    type: object
    required:
    - internalRxRefillabilityResponseList
    properties:
      internalRxRefillabilityResponseList:
        type: array
        items:
          $ref: '#/definitions/InternalRxRefillabilityResponse'
  InternalRxRefillabilityResponse:
    type: object
    required:
    - lastDispenseCode
    properties:
      lastDispenseCode:
        description: dispense code from the last dispense
        type: string
      defaultDaysSupply:
        type: number
        format: double
        description: Calculated Days supply based on the default dispensing quantity
      defaultDispensingQuantity:
        type: number
        format: double
        description: Default quantity to be dispensed
      nonRefillableReason:
        type: string
        description: Reason why the precription cannot be refilled
        enum:
        - COMPOUND_NONSYSTEM_PRODUCT
        - CONTROLLED_PRODUCT
        - COUPON_PLAN_USED
        - EXCEED_MAX_REFILLS_ALLOWED
        - EXTERNAL_DISPENSE_IN_PROGRESS
        - GOVERNMENT_PLAN_USED
        - INFRASTRUCTURE_ISSUE
        - INVALID_PRESCRIBER
        - NO_QUANTITY_REMAINING
        - OUT_OF_STATE_REFILL
        - PLAN_REQUIRES_CERTIFICATION
        - PRESCRIPTION_CLOSED
        - PRESCRIPTION_DELETED
        - PRESCRIPTION_EXPIRED
        - PRESCRIPTION_STORED
        - PRODUCT_DISCONTINUED
        - PRODUCT_EXCLUDED
        - WORKERS_COMP_USED
      refillable:
        type: boolean
        description: Flag to indicate if the prescription is eligible for refill or not
  ExecuteException:
    type: object
    properties:
      code:
        type: string
        description: The code identifying the type of error
      message:
        type: string
        description: The error message